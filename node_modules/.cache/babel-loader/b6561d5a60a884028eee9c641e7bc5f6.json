{"ast":null,"code":"import{IonAlert,IonBadge,IonButton,IonCard,IonCardContent,IonContent,IonIcon,IonImg,IonLabel,IonPage,IonRow}from\"@ionic/react\";import{chevronForwardOutline}from\"ionicons/icons\";import React,{useEffect,useState}from\"react\";import{useHistory}from\"react-router\";import*as EndPointURL from\"../../util/EndPointURL\";import{getDraftCount,httpGetCallWithoutHeader,httpPatchCallWithoutHeaderAndBody,loginWithAgent}from\"../../services/EndPointApi\";import\"./LandingPage.scss\";import Store from\"../../redux/Store\";import*as reduxActions from\"../../redux/actions/AllActions\";import Alert from\"../../components/alert/Alert\";import ClearReduxStore from\"../../util/ClearReduxStore\";function LandingPage(){let history=useHistory();var userDetails=Store.getState().CheckUserStatus.user;const[notficationCount,setNotificationCount]=useState(\"0\");const[showModal,setShowModal]=useState(false);const[errorMessage,setErrorMessage]=useState(\"\");const[input,setInput]=useState([]);const[alertPopup,setAlertPopup]=useState(false);const[draftCount,setdraftCount]=useState(0);useEffect(()=>{console.log(\"userDetails\",userDetails);ClearReduxStore();var response=httpGetCallWithoutHeader(EndPointURL.fetchCountsOfUnreadNotificationsUrl);response.then(result=>{var _result$data,_result$data$data;if(result===null||result===void 0?void 0:result.success)setNotificationCount(result===null||result===void 0?void 0:(_result$data=result.data)===null||_result$data===void 0?void 0:(_result$data$data=_result$data.data)===null||_result$data$data===void 0?void 0:_result$data$data.dataItems[0]);});},[]);useEffect(()=>{var _userDetails$agents,_userDetails$agents2;if(userDetails.userType===undefined||userDetails.agents===null){console.log(userDetails);}else if((userDetails===null||userDetails===void 0?void 0:(_userDetails$agents=userDetails.agents)===null||_userDetails$agents===void 0?void 0:_userDetails$agents.length)>1&&(userDetails===null||userDetails===void 0?void 0:userDetails.selectedAgent)==undefined){userDetails.agents.map((item,index)=>input.push({type:\"radio\",label:item.agentCode+\"-\"+item.agentName,value:item}));setInput(input);if(showModal){}else{console.log(\"showModal\",showModal);setShowModal(true);}console.log(\"yes showmaodal\",showModal);}else if((userDetails===null||userDetails===void 0?void 0:(_userDetails$agents2=userDetails.agents)===null||_userDetails$agents2===void 0?void 0:_userDetails$agents2.length)==1){var _userDetails$agents3;let data=userDetails===null||userDetails===void 0?void 0:(_userDetails$agents3=userDetails.agents)===null||_userDetails$agents3===void 0?void 0:_userDetails$agents3.find(e=>true);var selectedAgent=reduxActions.AddSelectedAgent(data);if(selectedAgent)Store.dispatch(selectedAgent);getAllSavedDraftsCount();}},[userDetails]);async function getAllSavedDraftsCount(){let resp=await getDraftCount();if((resp===null||resp===void 0?void 0:resp.success)&&(resp===null||resp===void 0?void 0:resp.data)>0){setdraftCount(resp===null||resp===void 0?void 0:resp.data);var test=Store.getState().VariableValues.showDraftInHome;setAlertPopup(Store.getState().VariableValues.showDraftInHome);var updateDRaftsPopupHome=await reduxActions.updateDRaftsPopupInHome(false);if(updateDRaftsPopupHome)Store.dispatch(updateDRaftsPopupHome);}}const clickedNotification=async()=>{if(notficationCount!==\"0\"){var response=await httpPatchCallWithoutHeaderAndBody(EndPointURL.fetchAllNotificationUrl);if(await response.success){setNotificationCount(\"0\");history.push(\"/notifications\");}}else history.push(\"/notifications\");};const selectUserType=async data=>{setShowModal(false);console.log(data);let url=EndPointURL.loginAgent+\"?agentCode=\"+data.agentCode+\"&agentType=\"+data.agentType;var endPointHeader={userName:userDetails.userName,userType:\"IMPORTER_APP\"};var response=await loginWithAgent(url,endPointHeader);console.log(response);if(await response.success){var result=response.data.data.dataItems[0];var accessToken=await reduxActions.AddAccessToKen(result.accessToken);if(accessToken)Store.dispatch(accessToken);var agentType=await reduxActions.AddAgentType(// result.user.activeCompanyCode\nresult.user.userType);if(agentType)Store.dispatch(agentType);// data.isAgentchanged = true;\nvar selectedAgent=await reduxActions.AddSelectedAgent(data);if(selectedAgent)Store.dispatch(selectedAgent);var test=Store.getState().CheckUserStatus;console.log(\"*****\",test);getAllSavedDraftsCount();}// }\n};const handleDraftPopup=(item,actionType)=>{if(actionType){setAlertPopup(false);history.push(\"/savedDrafts\");}else{}};const alertProps={isShow:alertPopup,message:\" \",//message,\ncontent:\"Continue where left off? \",icon:\"<img src='/assets/icon/draft.svg'/>\",alertAction:handleDraftPopup,//handleHeaderClick,\nitemName:draftCount+\" Transactions has been saved as drafts. Click continue to view the drafts page and complete ! <br/><br/>\",cancelPolicy:true,okButtonName:\"Continue\",cancelButtonName:\"Cancel\"};return/*#__PURE__*/React.createElement(IonPage,{className:\"landing-Page\"},/*#__PURE__*/React.createElement(IonAlert,{isOpen:showModal,onDidDismiss:()=>!showModal,header:\"Select Agent Code\",subHeader:errorMessage,backdropDismiss:false,inputs:input,cssClass:\"modal-alert\",buttons:[{text:\"Continue\",role:\"confirm\",handler:data=>{console.log(\"data\",data);if(data===undefined){setErrorMessage(\"Please Choose any to proceed\");return false;}else selectUserType(data);}}]}),/*#__PURE__*/React.createElement(IonContent,null,/*#__PURE__*/React.createElement(Alert,{alertProps:alertProps}),/*#__PURE__*/React.createElement(\"div\",{className:\"main-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"page-header\"},/*#__PURE__*/React.createElement(\"div\",{className:\"page-head-not-button\"},/*#__PURE__*/React.createElement(IonRow,{onClick:()=>clickedNotification()},/*#__PURE__*/React.createElement(IonBadge,{className:notficationCount===\"5+\"?\"not-badge1\":\"not-badge2\",color:\"danger\"},notficationCount),/*#__PURE__*/React.createElement(IonIcon,{src:\"assets/icon/bell.svg\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"page-head-text\"},/*#__PURE__*/React.createElement(\"span\",{className:\"page-header-welcome-name\"},\"Hello \",/*#__PURE__*/React.createElement(IonLabel,null,userDetails.firstName),\"!\"),/*#__PURE__*/React.createElement(\"span\",null,\"Welcome To Dubai Trade\")),/*#__PURE__*/React.createElement(\"div\",{className:\"page-head-button\"},/*#__PURE__*/React.createElement(IonButton,{className:\"tube-button\",onClick:()=>{history.push(\"/quickBook\");}},\"Quick Book\",/*#__PURE__*/React.createElement(IonIcon,{slot:\"end\",icon:chevronForwardOutline})))),/*#__PURE__*/React.createElement(\"div\",{className:\"my-bookings\"},/*#__PURE__*/React.createElement(IonCard,{className:\"page-card\"},/*#__PURE__*/React.createElement(IonImg,{src:\"assets/img/home-declaration.png\"}),/*#__PURE__*/React.createElement(IonCardContent,null,/*#__PURE__*/React.createElement(\"div\",{className:\"my-booking-txt\"},/*#__PURE__*/React.createElement(\"div\",{className:\"my-booking-txt-inner\"},/*#__PURE__*/React.createElement(\"span\",{className:\"header-txt\"},\"My Booking\"),/*#__PURE__*/React.createElement(\"span\",{className:\"sub-txt\"},\"Select container and book truck\")),/*#__PURE__*/React.createElement(\"div\",{className:\"book-button\"},/*#__PURE__*/React.createElement(IonButton,{className:\"tube-button\",onClick:()=>{history.push(\"/decl\");}},\"Book\")))))),/*#__PURE__*/React.createElement(\"div\",{className:\"my-bookings\"},/*#__PURE__*/React.createElement(IonCard,{className:\"page-card ion-text-center\"},/*#__PURE__*/React.createElement(IonImg,{src:\"assets/img/home-status.png\"}),/*#__PURE__*/React.createElement(IonCardContent,null,/*#__PURE__*/React.createElement(\"div\",{className:\"my-booking-txt\"},/*#__PURE__*/React.createElement(\"div\",{className:\"my-booking-txt-inner\"},/*#__PURE__*/React.createElement(\"span\",{className:\"header-txt\"},\"Status\"),/*#__PURE__*/React.createElement(\"span\",{className:\"sub-txt\"},\"Check status of your bookings\")),/*#__PURE__*/React.createElement(\"div\",{className:\"book-button\"},/*#__PURE__*/React.createElement(IonButton,{className:\"tube-button\",onClick:()=>history.push(\"/tabs/status\")},\"Track\")))))))));}export default LandingPage;","map":{"version":3,"sources":["D:/DT/ptmsCheckOutNew/New-MobileApp/src/pages/landingpage/LandingPage.tsx"],"names":["IonAlert","IonBadge","IonButton","IonCard","IonCardContent","IonContent","IonIcon","IonImg","IonLabel","IonPage","IonRow","chevronForwardOutline","React","useEffect","useState","useHistory","EndPointURL","getDraftCount","httpGetCallWithoutHeader","httpPatchCallWithoutHeaderAndBody","loginWithAgent","Store","reduxActions","Alert","ClearReduxStore","LandingPage","history","userDetails","getState","CheckUserStatus","user","notficationCount","setNotificationCount","showModal","setShowModal","errorMessage","setErrorMessage","input","setInput","alertPopup","setAlertPopup","draftCount","setdraftCount","console","log","response","fetchCountsOfUnreadNotificationsUrl","then","result","success","data","dataItems","userType","undefined","agents","length","selectedAgent","map","item","index","push","type","label","agentCode","agentName","value","find","e","AddSelectedAgent","dispatch","getAllSavedDraftsCount","resp","test","VariableValues","showDraftInHome","updateDRaftsPopupHome","updateDRaftsPopupInHome","clickedNotification","fetchAllNotificationUrl","selectUserType","url","loginAgent","agentType","endPointHeader","userName","accessToken","AddAccessToKen","AddAgentType","handleDraftPopup","actionType","alertProps","isShow","message","content","icon","alertAction","itemName","cancelPolicy","okButtonName","cancelButtonName","text","role","handler","firstName"],"mappings":"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","sourcesContent":["import {\r\n  IonAlert,\r\n  IonBadge,\r\n  IonButton,\r\n  IonCard,\r\n  IonCardContent,\r\n  IonContent,\r\n  IonIcon,\r\n  IonImg,\r\n  IonLabel,\r\n  IonPage,\r\n  IonRow,\r\n} from \"@ionic/react\";\r\nimport { chevronForwardOutline } from \"ionicons/icons\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { RouteComponentProps, useHistory } from \"react-router\";\r\nimport * as EndPointURL from \"../../util/EndPointURL\";\r\nimport {\r\n  getDraftCount,\r\n  httpGetCallWithoutHeader,\r\n  httpPatchCallWithoutHeaderAndBody,\r\n  loginWithAgent,\r\n} from \"../../services/EndPointApi\";\r\nimport \"./LandingPage.scss\";\r\nimport Store from \"../../redux/Store\";\r\nimport * as reduxActions from \"../../redux/actions/AllActions\";\r\nimport Alert from \"../../components/alert/Alert\";\r\nimport ClearReduxStore from \"../../util/ClearReduxStore\";\r\n\r\ninterface LandingPageProps extends RouteComponentProps {}\r\nfunction LandingPage() {\r\n  let history = useHistory();\r\n  var userDetails = Store.getState().CheckUserStatus.user;\r\n  const [notficationCount, setNotificationCount] = useState(\"0\");\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [errorMessage, setErrorMessage] = useState(\"\");\r\n  const [input, setInput] = useState([]);\r\n  const [alertPopup, setAlertPopup] = useState(false);\r\n  const [draftCount, setdraftCount] = useState(0);\r\n\r\n  useEffect(() => {\r\n    console.log(\"userDetails\", userDetails);\r\n    ClearReduxStore();\r\n    var response = httpGetCallWithoutHeader(\r\n      EndPointURL.fetchCountsOfUnreadNotificationsUrl\r\n    );\r\n    response.then((result) => {\r\n      if (result?.success)\r\n        setNotificationCount(result?.data?.data?.dataItems[0]);\r\n    });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (userDetails.userType === undefined || userDetails.agents === null) {\r\n      console.log(userDetails);\r\n    } else if (\r\n      userDetails?.agents?.length > 1 &&\r\n      userDetails?.selectedAgent == undefined\r\n    ) {\r\n      userDetails.agents.map((item: any, index: number) =>\r\n        input.push({\r\n          type: \"radio\",\r\n          label: item.agentCode + \"-\" + item.agentName,\r\n          value: item,\r\n        })\r\n      );\r\n      setInput(input);\r\n      if (showModal) {\r\n      } else {\r\n        console.log(\"showModal\", showModal);\r\n        setShowModal(true);\r\n      }\r\n      console.log(\"yes showmaodal\", showModal);\r\n    } else if (userDetails?.agents?.length == 1) {\r\n      let data = userDetails?.agents?.find((e) => true);\r\n      var selectedAgent = reduxActions.AddSelectedAgent(data);\r\n      if (selectedAgent) Store.dispatch(selectedAgent);\r\n      getAllSavedDraftsCount();\r\n    }\r\n  }, [userDetails]);\r\n\r\n  async function getAllSavedDraftsCount() {\r\n    let resp = await getDraftCount();\r\n    if (resp?.success && resp?.data > 0) {\r\n      setdraftCount(resp?.data);\r\n      var test = Store.getState().VariableValues.showDraftInHome;\r\n      setAlertPopup(Store.getState().VariableValues.showDraftInHome);\r\n      var updateDRaftsPopupHome = await reduxActions.updateDRaftsPopupInHome(\r\n        false\r\n      );\r\n      if (updateDRaftsPopupHome) Store.dispatch(updateDRaftsPopupHome);\r\n    }\r\n  }\r\n\r\n  const clickedNotification = async () => {\r\n    if (notficationCount !== \"0\") {\r\n      var response = await httpPatchCallWithoutHeaderAndBody(\r\n        EndPointURL.fetchAllNotificationUrl\r\n      );\r\n      if (await response.success) {\r\n        setNotificationCount(\"0\");\r\n        history.push(\"/notifications\");\r\n      }\r\n    } else history.push(\"/notifications\");\r\n  };\r\n\r\n  const selectUserType = async (data: any) => {\r\n    setShowModal(false);\r\n    console.log(data);\r\n    let url =\r\n      EndPointURL.loginAgent +\r\n      \"?agentCode=\" +\r\n      data.agentCode +\r\n      \"&agentType=\" +\r\n      data.agentType;\r\n\r\n    var endPointHeader = {\r\n      userName: userDetails.userName,\r\n      userType: \"IMPORTER_APP\",\r\n    };\r\n\r\n    var response = await loginWithAgent(url, endPointHeader);\r\n    console.log(response);\r\n    if (await response.success) {\r\n      var result = response.data.data.dataItems[0];\r\n      var accessToken = await reduxActions.AddAccessToKen(result.accessToken);\r\n      if (accessToken) Store.dispatch(accessToken);\r\n\r\n      var agentType = await reduxActions.AddAgentType(\r\n        // result.user.activeCompanyCode\r\n        result.user.userType\r\n      );\r\n      if (agentType) Store.dispatch(agentType);\r\n\r\n      // data.isAgentchanged = true;\r\n      var selectedAgent = await reduxActions.AddSelectedAgent(data);\r\n\r\n      if (selectedAgent) Store.dispatch(selectedAgent);\r\n\r\n      var test = Store.getState().CheckUserStatus;\r\n      console.log(\"*****\", test);\r\n      getAllSavedDraftsCount();\r\n    }\r\n    // }\r\n  };\r\n\r\n  const handleDraftPopup = (item, actionType) => {\r\n    if (actionType) {\r\n      setAlertPopup(false);\r\n      history.push(\"/savedDrafts\");\r\n    } else {\r\n    }\r\n  };\r\n\r\n  const alertProps = {\r\n    isShow: alertPopup,\r\n    message: \" \", //message,\r\n    content: \"Continue where left off? \",\r\n    icon: \"<img src='/assets/icon/draft.svg'/>\",\r\n    alertAction: handleDraftPopup, //handleHeaderClick,\r\n\r\n    itemName:\r\n      draftCount +\r\n      \" Transactions has been saved as drafts. Click continue to view the drafts page and complete ! <br/><br/>\",\r\n    cancelPolicy: true,\r\n    okButtonName: \"Continue\",\r\n    cancelButtonName: \"Cancel\",\r\n  };\r\n  return (\r\n    <IonPage className=\"landing-Page\">\r\n      <IonAlert\r\n        isOpen={showModal}\r\n        onDidDismiss={() => !showModal}\r\n        header={\"Select Agent Code\"}\r\n        subHeader={errorMessage}\r\n        backdropDismiss={false}\r\n        inputs={input}\r\n        cssClass=\"modal-alert\"\r\n        buttons={[\r\n          {\r\n            text: \"Continue\",\r\n            role: \"confirm\",\r\n            handler: (data) => {\r\n              console.log(\"data\", data);\r\n              if (data === undefined) {\r\n                setErrorMessage(\"Please Choose any to proceed\");\r\n                return false;\r\n              } else selectUserType(data);\r\n            },\r\n          },\r\n        ]}\r\n      />\r\n      <IonContent>\r\n        <Alert alertProps={alertProps} />\r\n        <div className=\"main-container\">\r\n          <div className=\"page-header\">\r\n            <div className=\"page-head-not-button\">\r\n              <IonRow onClick={() => clickedNotification()}>\r\n                <IonBadge\r\n                  className={\r\n                    notficationCount === \"5+\" ? \"not-badge1\" : \"not-badge2\"\r\n                  }\r\n                  color=\"danger\"\r\n                >\r\n                  {notficationCount}\r\n                </IonBadge>\r\n                <IonIcon src=\"assets/icon/bell.svg\" />\r\n              </IonRow>\r\n            </div>\r\n            <div className=\"page-head-text\">\r\n              <span className=\"page-header-welcome-name\">\r\n                Hello <IonLabel>{userDetails.firstName}</IonLabel>!\r\n              </span>\r\n              <span>Welcome To Dubai Trade</span>\r\n            </div>\r\n            <div className=\"page-head-button\">\r\n              <IonButton\r\n                className=\"tube-button\"\r\n                onClick={() => {\r\n                  history.push(\"/quickBook\");\r\n                }}\r\n              >\r\n                Quick Book\r\n                <IonIcon slot=\"end\" icon={chevronForwardOutline} />\r\n              </IonButton>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"my-bookings\">\r\n            <IonCard className=\"page-card\">\r\n              <IonImg src=\"assets/img/home-declaration.png\" />\r\n              <IonCardContent>\r\n                <div className=\"my-booking-txt\">\r\n                  <div className=\"my-booking-txt-inner\">\r\n                    <span className=\"header-txt\">My Booking</span>\r\n                    <span className=\"sub-txt\">\r\n                      Select container and book truck\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"book-button\">\r\n                    <IonButton\r\n                      className=\"tube-button\"\r\n                      onClick={() => {\r\n                        history.push(\"/decl\");\r\n                      }}\r\n                    >\r\n                      Book\r\n                    </IonButton>\r\n                  </div>\r\n                </div>\r\n              </IonCardContent>\r\n            </IonCard>\r\n          </div>\r\n\r\n          <div className=\"my-bookings\">\r\n            <IonCard className=\"page-card ion-text-center\">\r\n              <IonImg src=\"assets/img/home-status.png\" />\r\n              <IonCardContent>\r\n                <div className=\"my-booking-txt\">\r\n                  <div className=\"my-booking-txt-inner\">\r\n                    <span className=\"header-txt\">Status</span>\r\n                    <span className=\"sub-txt\">\r\n                      Check status of your bookings\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"book-button\">\r\n                    <IonButton\r\n                      className=\"tube-button\"\r\n                      onClick={() => history.push(\"/tabs/status\")}\r\n                    >\r\n                      Track\r\n                    </IonButton>\r\n                  </div>\r\n                </div>\r\n              </IonCardContent>\r\n            </IonCard>\r\n          </div>\r\n        </div>\r\n      </IonContent>\r\n    </IonPage>\r\n  );\r\n}\r\n\r\nexport default LandingPage;\r\n"]},"metadata":{},"sourceType":"module"}