{"ast":null,"code":"import{IonCard,IonCardContent,IonCol,IonContent,IonHeader,IonLabel,IonPage,IonRow}from\"@ionic/react\";import React,{useState}from\"react\";import{connect}from\"react-redux\";import{useHistory}from\"react-router-dom\";import Badge from\"../../../components/Badge/Badge\";import ContainerCard from\"../../../components/ContainerCard\";import Footer from\"../../../components/Footer/Footer\";import Icon from\"../../../components/Icon\";import*as reduxActions from\"../../../redux/actionTypes/AllActionTypes\";import Store from\"../../../redux/Store\";import*as EndPointApi from\"../../../services/EndPointApi\";import*as EndPointURL from\"../../../util/EndPointURL\";import CenterFooterButton from\"../../CenterFooterButton\";import\"./DeclSearch.scss\";import SearchCompo from\"./SearchCompo\";const DeclSearch=(props,_ref)=>{let{onclickEvent,allStoreDeclarations,updateBoesInCart,updateContainersInCart}=_ref;var count=0;var allDecl=props.allStoreDeclarations;console.log(allDecl);const[selectedSegment,setselectedSegment]=useState(props.location.state);const[apiResult,setapiResult]=useState([]);// var text={`Please search to get the ${selectedSegment} number results`}\n//var t = {`search with ${selectedSegment} number`}\nconst[warningMessage,setwarningMessage]=useState(\"\");let history=useHistory();const contanerIconProps={name:\"container\",slot:\"\",class:\"zoom12\",styleProps:{zoom:2.8}};async function searchForResult(searchText,segment){var response;setapiResult([]);var param;if(segment===\"declaration\"){param=\"pgSize=10&pgNo=0&option=ALL&locale=en&bookingNumber=\"+searchText;}else{param=\"pgSize=10&pgNo=0&option=ALL&locale=en&containerNumber=\"+searchText;}if(searchText){var _response,_response4,_response4$data,_response4$data$eleme;response=await EndPointApi.fetchAllDeclaration(EndPointURL.declarationUrl+param);console.log(response);if(!((_response=response)===null||_response===void 0?void 0:_response.success)){var _response2,_response2$data,_response2$data$eleme,_response3,_response3$data;console.log(response,(_response2=response)===null||_response2===void 0?void 0:(_response2$data=_response2.data)===null||_response2$data===void 0?void 0:(_response2$data$eleme=_response2$data.elements)===null||_response2$data$eleme===void 0?void 0:_response2$data$eleme.length);setwarningMessage((_response3=response)===null||_response3===void 0?void 0:(_response3$data=_response3.data)===null||_response3$data===void 0?void 0:_response3$data.message);}if(((_response4=response)===null||_response4===void 0?void 0:(_response4$data=_response4.data)===null||_response4$data===void 0?void 0:(_response4$data$eleme=_response4$data.elements)===null||_response4$data$eleme===void 0?void 0:_response4$data$eleme.length)>0){var _response5,_response5$data;console.log(response);setwarningMessage(\"\");setapiResult((_response5=response)===null||_response5===void 0?void 0:(_response5$data=_response5.data)===null||_response5$data===void 0?void 0:_response5$data.elements);}else{setwarningMessage(\"No Result found, search with another number\");}}}function cardClicked(item){allDecl.forEach((element,index)=>{if(item.referenceNumber===element.referenceNumber){allDecl[index].currentSelection=true;allDecl[index].containerList.index=index;element.containerList.forEach(container=>{//container.\n});props.updateBoesInCart(allDecl);history.push(\"/container\",allStoreDeclarations);}});}function updateContainerInCart(item){console.log(item);item.selected=true;// allDecl[index].selectedNumber = containerList[index]\n//       .selectedNumber\n//       ? containerList[index].selectedNumber\n//       : 0;\n//     containerList[index].selectedNumber =\n//       containerList[index].selectedNumber + 1;\nallDecl.map((element,index)=>{if(element.referenceNumber===item.boeNumber){allDecl[index].selectedNumber=allDecl[index].selectedNumber?allDecl[index].selectedNumber:0;allDecl[index].selectedNumber=allDecl[index].selectedNumber+1;count=item.selectedNumber;}});props.updateContainersInCart(item);history.push(\"/containerCart\");}return/*#__PURE__*/React.createElement(IonPage,null,/*#__PURE__*/React.createElement(IonHeader,null,/*#__PURE__*/React.createElement(SearchCompo,{setSegment:val=>{setselectedSegment(val);searchForResult(\"\");},selectedSegment:selectedSegment,searchForResult:searchForResult,clearText:()=>setwarningMessage(\"\"),name:\"declNumber\",value:\"form.declNumber\",label:\"Declaration Number\",errors:\"errors.declNumber\",type:\"text\",required:true,onChange:val=>{setselectedSegment(val);searchForResult(\"\");},datatype:\"TEXT\",placeholder:\"\"//icon={icon.declNumber}\n//onBlur={onBlur}\n,pattern:\"###-########-###\",description:\" Format xxx-yyyyyyyy-zz\"})),/*#__PURE__*/React.createElement(IonContent,{className:\"search-lense1\"},(apiResult.length===0||warningMessage!==\"\")&&/*#__PURE__*/React.createElement(IonRow,{className:\"search-lense\"},/*#__PURE__*/React.createElement(IonCol,{className:\"search-body-text\"},warningMessage&&/*#__PURE__*/React.createElement(\"div\",{className:\"warning-message\"},warningMessage),warningMessage===\"\"&&/*#__PURE__*/React.createElement(IonLabel,null,\" \",\"Please search to get the \",selectedSegment,\" number results\"))),apiResult.map((element,index)=>{var _element$containerLis;return/*#__PURE__*/React.createElement(React.Fragment,null,selectedSegment===\"container\"?/*#__PURE__*/React.createElement(\"div\",{className:\"container-list\"},element===null||element===void 0?void 0:(_element$containerLis=element.containerList)===null||_element$containerLis===void 0?void 0:_element$containerLis.map((item,index)=>{return/*#__PURE__*/React.createElement(ContainerCard,{containerItem:item,key:index,containerClick:()=>updateContainerInCart(item)// index={currentDecl?.containerList.index}\n});})):/*#__PURE__*/React.createElement(IonCard,{key:index,className:element.selected?\"outer-card boxShadow \":\"outer-card lightShadow\",onClick:()=>cardClicked(element)},\" \",/*#__PURE__*/React.createElement(IonCardContent,null,/*#__PURE__*/React.createElement(\"div\",{className:\"container-card\"},/*#__PURE__*/React.createElement(\"div\",{className:\"twoItems borderBottom\"},/*#__PURE__*/React.createElement(\"div\",{className:\"eachItemLeft\"},/*#__PURE__*/React.createElement(\"div\",{className:\"decl-info\"},/*#__PURE__*/React.createElement(\"span\",{className:\"decl-number\"},/*#__PURE__*/React.createElement(IonLabel,{class:\"gray-text\"},\"Declaration#\")),/*#__PURE__*/React.createElement(\"span\",{className:\"decl-comments\"},element.referenceNumber))),/*#__PURE__*/React.createElement(\"div\",{className:\"middle-item\"},/*#__PURE__*/React.createElement(\"div\",{className:\"dov\"},/*#__PURE__*/React.createElement(\"span\",{className:\"\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"eachItemRight\"},/*#__PURE__*/React.createElement(\"div\",{className:\"dov\"},/*#__PURE__*/React.createElement(\"span\",{className:\"dov-text\"},/*#__PURE__*/React.createElement(IonLabel,{class:\"gray-text\"},\"Deliver Order validity\")),/*#__PURE__*/React.createElement(\"span\",{className:\"dov-number\"},element.deliveryOrderValidity)))),/*#__PURE__*/React.createElement(\"div\",{className:\"twoItems\"},/*#__PURE__*/React.createElement(\"div\",{className:\"eachItemLeft\"},/*#__PURE__*/React.createElement(\"div\",{className:\"decl-info\"},/*#__PURE__*/React.createElement(\"span\",{className:\"decl-number\"},\" \",/*#__PURE__*/React.createElement(IonLabel,{class:\"gray-text\"},\"Consignee\")),/*#__PURE__*/React.createElement(\"span\",{className:\"decl-comments\"},element.consigneeDetails))),/*#__PURE__*/React.createElement(\"div\",{className:\"middle-item\"},/*#__PURE__*/React.createElement(\"div\",{className:\"dov\"},/*#__PURE__*/React.createElement(\"span\",{className:\"\"},/*#__PURE__*/React.createElement(Icon,{iconProps:contanerIconProps})))),/*#__PURE__*/React.createElement(\"div\",{className:\"eachItemRight\"},/*#__PURE__*/React.createElement(\"div\",{className:\"secondRow\"},/*#__PURE__*/React.createElement(\"div\",{className:\"dov\"},/*#__PURE__*/React.createElement(\"span\",{className:\"dov-number\"},element.containerList.length,\" Nos.\"),element.selectedNumber>0&&/*#__PURE__*/React.createElement(\"span\",{className:\"dov-selected-number\"},element.selectedNumber,\" selected.\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"secondRow\"},/*#__PURE__*/React.createElement(\"div\",{className:\"badgeItem\"},/*#__PURE__*/React.createElement(\"div\",{className:\"dov\"},/*#__PURE__*/React.createElement(\"span\",{className:\"\"},/*#__PURE__*/React.createElement(Badge,{status:element.status})))))))))));}),apiResult.length>0&&/*#__PURE__*/React.createElement(CenterFooterButton,{iconType:\"cart\"//clickEvent={goToContainerCart}\n})),apiResult.length>0&&/*#__PURE__*/React.createElement(Footer,null));};const mapStateToProps=state=>{console.log(\"chnageddddd======\");return{allStoreDeclarations:state.Cart,cartNumber:state.VariableValues,agent:state.CheckUserStatus.user.selectedAgent};};const mapDispatchToProps=()=>{return{addDeclarationToCart:item=>{Store.dispatch({type:reduxActions.ADD_TO_CART,payLoad:item});},updateContainersInCart:item=>{console.log(item);Store.dispatch({type:reduxActions.UPDATE_CONTAINER_IN_CART,payLoad:item});},removeAllContainersInCart:()=>{Store.dispatch({type:reduxActions.CLEAR_CART});},updateBoesInCart:item=>{console.log(item);Store.dispatch({type:reduxActions.UPDATE_BOE_IN_CART,payLoad:item});}};};export default connect(mapStateToProps,mapDispatchToProps)(DeclSearch);","map":{"version":3,"sources":["D:/DT/ptmsCheckOutNew/New-MobileApp/src/pages/declaration/SearchPage/DeclSearch.tsx"],"names":["IonCard","IonCardContent","IonCol","IonContent","IonHeader","IonLabel","IonPage","IonRow","React","useState","connect","useHistory","Badge","ContainerCard","Footer","Icon","reduxActions","Store","EndPointApi","EndPointURL","CenterFooterButton","SearchCompo","DeclSearch","props","onclickEvent","allStoreDeclarations","updateBoesInCart","updateContainersInCart","count","allDecl","console","log","selectedSegment","setselectedSegment","location","state","apiResult","setapiResult","warningMessage","setwarningMessage","history","contanerIconProps","name","slot","class","styleProps","zoom","searchForResult","searchText","segment","response","param","fetchAllDeclaration","declarationUrl","success","data","elements","length","message","cardClicked","item","forEach","element","index","referenceNumber","currentSelection","containerList","container","push","updateContainerInCart","selected","map","boeNumber","selectedNumber","val","deliveryOrderValidity","consigneeDetails","status","mapStateToProps","Cart","cartNumber","VariableValues","agent","CheckUserStatus","user","selectedAgent","mapDispatchToProps","addDeclarationToCart","dispatch","type","ADD_TO_CART","payLoad","UPDATE_CONTAINER_IN_CART","removeAllContainersInCart","CLEAR_CART","UPDATE_BOE_IN_CART"],"mappings":"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","sourcesContent":["import {\r\n  IonBackButton,\r\n  IonButton,\r\n  IonButtons,\r\n  IonCard,\r\n  IonCardContent,\r\n  IonCol,\r\n  IonContent,\r\n  IonHeader,\r\n  IonIcon,\r\n  IonLabel,\r\n  IonModal,\r\n  IonPage,\r\n  IonRow,\r\n  IonSearchbar,\r\n  IonSegment,\r\n  IonSegmentButton,\r\n} from \"@ionic/react\";\r\nimport {\r\n  arrowBack,\r\n  arrowBackOutline,\r\n  arrowBackSharp,\r\n  arrowUp,\r\n} from \"ionicons/icons\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport Badge from \"../../../components/Badge/Badge\";\r\nimport ContainerCard from \"../../../components/ContainerCard\";\r\nimport Footer from \"../../../components/Footer/Footer\";\r\nimport Icon from \"../../../components/Icon\";\r\nimport * as reduxActions from \"../../../redux/actionTypes/AllActionTypes\";\r\nimport Store from \"../../../redux/Store\";\r\nimport * as EndPointApi from \"../../../services/EndPointApi\";\r\nimport * as EndPointURL from \"../../../util/EndPointURL\";\r\nimport CenterFooterButton from \"../../CenterFooterButton\";\r\nimport \"./DeclSearch.scss\";\r\nimport SearchCompo from \"./SearchCompo\";\r\n\r\ninterface DeclSearchProps {\r\n  onclickEvent?: (openStatus) => void;\r\n  allStoreDeclarations: any;\r\n  updateBoesInCart;\r\n  location;\r\n  updateContainersInCart;\r\n}\r\nconst DeclSearch: React.FC<DeclSearchProps> = (\r\n  props,\r\n  {\r\n    onclickEvent,\r\n    allStoreDeclarations,\r\n    updateBoesInCart,\r\n    updateContainersInCart,\r\n  }\r\n) => {\r\n  var count = 0;\r\n  var allDecl = props.allStoreDeclarations;\r\n  console.log(allDecl);\r\n  const [selectedSegment, setselectedSegment] = useState(props.location.state);\r\n  const [apiResult, setapiResult] = useState<any>([]);\r\n  // var text={`Please search to get the ${selectedSegment} number results`}\r\n  //var t = {`search with ${selectedSegment} number`}\r\n  const [warningMessage, setwarningMessage] = useState(\"\");\r\n\r\n  let history = useHistory();\r\n  const contanerIconProps = {\r\n    name: \"container\",\r\n    slot: \"\",\r\n    class: \"zoom12\",\r\n    styleProps: { zoom: 2.8 },\r\n  };\r\n\r\n  async function searchForResult(searchText, segment?) {\r\n    var response;\r\n    setapiResult([]);\r\n    var param;\r\n    if (segment === \"declaration\") {\r\n      param =\r\n        \"pgSize=10&pgNo=0&option=ALL&locale=en&bookingNumber=\" + searchText;\r\n    } else {\r\n      param =\r\n        \"pgSize=10&pgNo=0&option=ALL&locale=en&containerNumber=\" + searchText;\r\n    }\r\n    if (searchText) {\r\n      response = await EndPointApi.fetchAllDeclaration(\r\n        EndPointURL.declarationUrl + param\r\n      );\r\n      console.log(response);\r\n\r\n      if (!response?.success) {\r\n        console.log(response, response?.data?.elements?.length);\r\n        setwarningMessage(response?.data?.message);\r\n      }\r\n      if (response?.data?.elements?.length > 0) {\r\n        console.log(response);\r\n        setwarningMessage(\"\");\r\n        setapiResult(response?.data?.elements);\r\n      } else {\r\n        setwarningMessage(\"No Result found, search with another number\");\r\n      }\r\n    }\r\n  }\r\n\r\n  function cardClicked(item) {\r\n    allDecl.forEach((element, index) => {\r\n      if (item.referenceNumber === element.referenceNumber) {\r\n        allDecl[index].currentSelection = true;\r\n        allDecl[index].containerList.index = index;\r\n        element.containerList.forEach((container) => {\r\n          //container.\r\n        });\r\n        props.updateBoesInCart(allDecl);\r\n        history.push(\"/container\", allStoreDeclarations);\r\n      }\r\n    });\r\n  }\r\n\r\n  function updateContainerInCart(item) {\r\n    console.log(item);\r\n    item.selected = true;\r\n    // allDecl[index].selectedNumber = containerList[index]\r\n    //       .selectedNumber\r\n    //       ? containerList[index].selectedNumber\r\n    //       : 0;\r\n    //     containerList[index].selectedNumber =\r\n    //       containerList[index].selectedNumber + 1;\r\n\r\n    allDecl.map((element, index) => {\r\n      if (element.referenceNumber === item.boeNumber) {\r\n        allDecl[index].selectedNumber = allDecl[index].selectedNumber\r\n          ? allDecl[index].selectedNumber\r\n          : 0;\r\n        allDecl[index].selectedNumber = allDecl[index].selectedNumber + 1;\r\n        count = item.selectedNumber;\r\n      }\r\n    });\r\n    props.updateContainersInCart(item);\r\n    history.push(\"/containerCart\");\r\n  }\r\n\r\n  return (\r\n    <IonPage>\r\n      <IonHeader>\r\n        <SearchCompo\r\n          setSegment={(val) => {\r\n            setselectedSegment(val);\r\n            searchForResult(\"\");\r\n          }}\r\n          selectedSegment={selectedSegment}\r\n          searchForResult={searchForResult}\r\n          clearText={() => setwarningMessage(\"\")}\r\n          name={\"declNumber\"}\r\n          value={\"form.declNumber\"}\r\n          label=\"Declaration Number\"\r\n          errors={\"errors.declNumber\"}\r\n          type=\"text\"\r\n          required={true}\r\n          onChange={(val) => {\r\n            setselectedSegment(val);\r\n            searchForResult(\"\");\r\n          }}\r\n          datatype=\"TEXT\"\r\n          placeholder=\"\"\r\n          //icon={icon.declNumber}\r\n          //onBlur={onBlur}\r\n          pattern=\"###-########-###\"\r\n          description=\" Format xxx-yyyyyyyy-zz\"\r\n        />\r\n      </IonHeader>\r\n      <IonContent className=\"search-lense1\">\r\n        {(apiResult.length === 0 || warningMessage !== \"\") && (\r\n          <IonRow className=\"search-lense\">\r\n            <IonCol className=\"search-body-text\">\r\n              {warningMessage && (\r\n                <div className=\"warning-message\">{warningMessage}</div>\r\n              )}\r\n              {warningMessage === \"\" && (\r\n                <IonLabel>\r\n                  {\" \"}\r\n                  Please search to get the {selectedSegment} number results\r\n                </IonLabel>\r\n              )}\r\n            </IonCol>\r\n          </IonRow>\r\n        )}\r\n        {apiResult.map((element, index) => (\r\n          <>\r\n            {selectedSegment === \"container\" ? (\r\n              <div className=\"container-list\">\r\n                {element?.containerList?.map((item, index) => {\r\n                  return (\r\n                    <ContainerCard\r\n                      containerItem={item}\r\n                      key={index}\r\n                      containerClick={() => updateContainerInCart(item)}\r\n                      // index={currentDecl?.containerList.index}\r\n                    />\r\n                  );\r\n                })}\r\n              </div>\r\n            ) : (\r\n              <IonCard\r\n                key={index}\r\n                className={\r\n                  element.selected\r\n                    ? \"outer-card boxShadow \"\r\n                    : \"outer-card lightShadow\"\r\n                }\r\n                onClick={() => cardClicked(element)}\r\n              >\r\n                {\" \"}\r\n                <IonCardContent>\r\n                  <div className=\"container-card\">\r\n                    {/* <div className=\"list-logo\">\r\n                              <RoundedAvatar\r\n                                color={color}\r\n                                name={item.comments}\r\n                              />\r\n                            </div> */}\r\n                    <div className=\"twoItems borderBottom\">\r\n                      <div className=\"eachItemLeft\">\r\n                        <div className=\"decl-info\">\r\n                          <span className=\"decl-number\">\r\n                            <IonLabel class=\"gray-text\">Declaration#</IonLabel>\r\n                          </span>\r\n                          <span className=\"decl-comments\">\r\n                            {element.referenceNumber}\r\n                          </span>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"middle-item\">\r\n                        <div className=\"dov\">\r\n                          <span className=\"\">\r\n                            {/* <Icon\r\n                                        iconProps={this.contanerIconProps}\r\n                                      /> */}\r\n                          </span>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"eachItemRight\">\r\n                        <div className=\"dov\">\r\n                          <span className=\"dov-text\">\r\n                            <IonLabel class=\"gray-text\">\r\n                              Deliver Order validity\r\n                            </IonLabel>\r\n                          </span>\r\n                          <span className=\"dov-number\">\r\n                            {element.deliveryOrderValidity}\r\n                          </span>\r\n                        </div>\r\n                      </div>\r\n                      {/* </div> */}\r\n                    </div>\r\n                    <div className=\"twoItems\">\r\n                      <div className=\"eachItemLeft\">\r\n                        <div className=\"decl-info\">\r\n                          <span className=\"decl-number\">\r\n                            {\" \"}\r\n                            <IonLabel class=\"gray-text\">Consignee</IonLabel>\r\n                          </span>\r\n                          <span className=\"decl-comments\">\r\n                            {element.consigneeDetails}\r\n                            {/* {item.consigneeDetails} */}\r\n                          </span>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"middle-item\">\r\n                        <div className=\"dov\">\r\n                          <span className=\"\">\r\n                            <Icon iconProps={contanerIconProps} />\r\n                          </span>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"eachItemRight\">\r\n                        <div className=\"secondRow\">\r\n                          <div className=\"dov\">\r\n                            <span className=\"dov-number\">\r\n                              {element.containerList.length} Nos.\r\n                            </span>\r\n                            {element.selectedNumber > 0 && (\r\n                              <span className=\"dov-selected-number\">\r\n                                {element.selectedNumber} selected.\r\n                              </span>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"secondRow\">\r\n                          <div className=\"badgeItem\">\r\n                            <div className=\"dov\">\r\n                              <span className=\"\">\r\n                                <Badge status={element.status} />\r\n                              </span>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </IonCardContent>\r\n              </IonCard>\r\n            )}\r\n          </>\r\n        ))}\r\n        {apiResult.length > 0 && (\r\n          <CenterFooterButton\r\n            iconType=\"cart\"\r\n            //clickEvent={goToContainerCart}\r\n          />\r\n        )}\r\n      </IonContent>\r\n      {apiResult.length > 0 && <Footer />}\r\n      {/* </IonModal> */}\r\n    </IonPage>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state: any) => {\r\n  console.log(\"chnageddddd======\");\r\n  return {\r\n    allStoreDeclarations: state.Cart,\r\n    cartNumber: state.VariableValues,\r\n    agent: state.CheckUserStatus.user.selectedAgent,\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = () => {\r\n  return {\r\n    addDeclarationToCart: (item: any) => {\r\n      Store.dispatch({\r\n        type: reduxActions.ADD_TO_CART,\r\n        payLoad: item,\r\n      });\r\n    },\r\n    updateContainersInCart: (item: any) => {\r\n      console.log(item);\r\n      Store.dispatch({\r\n        type: reduxActions.UPDATE_CONTAINER_IN_CART,\r\n        payLoad: item,\r\n      });\r\n    },\r\n    removeAllContainersInCart: () => {\r\n      Store.dispatch({ type: reduxActions.CLEAR_CART });\r\n    },\r\n    updateBoesInCart: (item) => {\r\n      console.log(item);\r\n      Store.dispatch({\r\n        type: reduxActions.UPDATE_BOE_IN_CART,\r\n        payLoad: item,\r\n      });\r\n    },\r\n  };\r\n};\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DeclSearch);\r\n"]},"metadata":{},"sourceType":"module"}